{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Yarp": "Information"
    }
  },
  "AllowedHosts": "*",
  "Jwt": {
    "Secret": "",
    "Issuer": "erp-system",
    "Audience": "erp-clients"
  },
  "Services": {
    "UserManagement": "http://user-management:8080",
    "Inventory": "http://inventory:8080",
    "Sales": "http://sales:8080",
    "Financial": "http://financial:8080",
    "Dashboard": "http://dashboard:8080"
  },
  "ReverseProxy": {
    "Routes": {
      "user-auth-route": {
        "ClusterId": "user-cluster",
        "Match": {
          "Path": "/api/v1/auth/{**catch-all}"
        }
      },
      "user-route": {
        "ClusterId": "user-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/users/{**catch-all}"
        }
      },
      "inventory-products-route": {
        "ClusterId": "inventory-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/products/{**catch-all}"
        }
      },
      "inventory-categories-route": {
        "ClusterId": "inventory-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/categories/{**catch-all}"
        }
      },
      "inventory-shop-route": {
        "ClusterId": "inventory-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/shop/{**catch-all}"
        }
      },
      "inventory-stock-route": {
        "ClusterId": "inventory-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/stock-movements/{**catch-all}"
        }
      },
      "sales-orders-route": {
        "ClusterId": "sales-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/orders/{**catch-all}"
        }
      },
      "sales-customers-route": {
        "ClusterId": "sales-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/customers/{**catch-all}"
        }
      },
      "sales-invoices-route": {
        "ClusterId": "sales-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/invoices/{**catch-all}"
        }
      },
      "sales-graphql-route": {
        "ClusterId": "sales-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/sales/graphql/{**catch-all}"
        },
        "Transforms": [
          {
            "PathPattern": "/graphql/{**catch-all}"
          }
        ]
      },
      "financial-accounts-route": {
        "ClusterId": "financial-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/accounts/{**catch-all}"
        }
      },
      "financial-transactions-route": {
        "ClusterId": "financial-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/transactions/{**catch-all}"
        }
      },
      "financial-budgets-route": {
        "ClusterId": "financial-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/budgets/{**catch-all}"
        }
      },
      "financial-reports-route": {
        "ClusterId": "financial-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/reports/{**catch-all}"
        }
      },
      "dashboard-metrics-route": {
        "ClusterId": "dashboard-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/dashboard/{**catch-all}"
        }
      },
      "dashboard-kpis-route": {
        "ClusterId": "dashboard-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/kpis/{**catch-all}"
        }
      },
      "dashboard-alerts-route": {
        "ClusterId": "dashboard-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/alerts/{**catch-all}"
        }
      },
      "dashboard-database-route": {
        "ClusterId": "dashboard-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/api/v1/database/{**catch-all}"
        }
      },
      "dashboard-graphql-route": {
        "ClusterId": "dashboard-cluster",
        "AuthorizationPolicy": "authenticated",
        "Match": {
          "Path": "/dashboard/graphql/{**catch-all}"
        },
        "Transforms": [
          {
            "PathPattern": "/graphql/{**catch-all}"
          }
        ]
      },
      "dashboard-hub-route": {
        "ClusterId": "dashboard-cluster",
        "Match": {
          "Path": "/dashboardHub/{**catch-all}"
        }
      }
    },
    "Clusters": {
      "user-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "{Services:UserManagement}"
          }
        },
        "HttpRequest": {
          "Timeout": "00:01:00"
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Path": "/health/ready"
          }
        }
      },
      "inventory-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "{Services:Inventory}"
          }
        },
        "HttpRequest": {
          "Timeout": "00:01:00"
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Path": "/health/ready"
          }
        }
      },
      "sales-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "{Services:Sales}"
          }
        },
        "HttpRequest": {
          "Timeout": "00:01:00"
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Path": "/health/ready"
          }
        }
      },
      "financial-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "{Services:Financial}"
          }
        },
        "HttpRequest": {
          "Timeout": "00:01:00"
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Path": "/health/ready"
          }
        }
      },
      "dashboard-cluster": {
        "Destinations": {
          "destination1": {
            "Address": "{Services:Dashboard}"
          }
        },
        "HttpRequest": {
          "Timeout": "00:01:00"
        },
        "HealthCheck": {
          "Active": {
            "Enabled": true,
            "Interval": "00:00:10",
            "Timeout": "00:00:05",
            "Path": "/health/ready"
          }
        }
      }
    }
  },
  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "RealIpHeader": "X-Real-IP",
    "ClientIdHeader": "X-ClientId",
    "HttpStatusCode": 429,
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1m",
        "Limit": 100
      },
      {
        "Endpoint": "*",
        "Period": "1h",
        "Limit": 1000
      }
    ]
  },
  "IpRateLimitPolicies": {
    "IpRules": [
      {
        "Ip": "127.0.0.1",
        "Rules": [
          {
            "Endpoint": "*",
            "Period": "1m",
            "Limit": 1000
          }
        ]
      }
    ]
  },
  "Serilog": {
    "Using": [ "Serilog.Sinks.Console" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning",
        "Yarp": "Information"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId" ]
  }
}
